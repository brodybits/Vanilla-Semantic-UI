vs.embed=function(t,n){var a,o=n.selector,r=n.className,c=n.sources,i=n.error,d=n.metadata,e=n.namespace,l=n.templates,u="module-"+e,s=(t.querySelectorAll(o.placeholder),t.querySelectorAll(o.icon),t.querySelectorAll(o.embed));t[u];return a={initialize:function(){a.debug("Initializing embed"),a.determine.autoplay(),a.create(),a.bind.events(),a.instantiate()},instantiate:function(){a.verbose("Storing instance of module",a),a,t[u]=a},destroy:function(){a.verbose("Destroying previous instance of embed"),a.reset(),t.removeEvents(),t[u]=void 0},refresh:function(){a.verbose("Refreshing selector cache"),t.querySelector(o.placeholder),t.querySelector(o.icon),s=t.querySelector(o.embed)},bind:{events:function(){a.has.placeholder()&&(a.debug("Adding placeholder events"),t.onclick=function(e){(vs.checkTarget(e,o.placeholder)||vs.checkTarget(e,o.icon))&&a.createAndShow()})}},create:function(){a.get.placeholder()?a.createPlaceholder():a.createAndShow()},createPlaceholder:function(e){var o=a.get.icon(),r=a.get.url();a.generate.embed(r);e=e||a.get.placeholder(),t.innerHTML=l.placeholder(e,o),a.debug("Creating placeholder for embed",e,o)},createEmbed:function(e){a.refresh(),e=e||a.get.url(),(s=document.createElement("div")).classList.add(r.embed),s.innerHTML=a.generate.embed(e),t.append(s),n.onCreate.call(t,e),a.debug("Creating embed object",s)},changeEmbed:function(e){s.innerHTML=a.generate.embed(e)},createAndShow:function(){a.createEmbed(),a.show()},change:function(e,o,r){a.debug("Changing video to ",e,o,r),t.dataset[d.source]=e,t.dataset[d.id]=o,r?t.dataset[(d.url,r)]:t.dataset[d.url]=void 0,a.has.embed()?a.changeEmbed():a.create()},reset:function(){a.debug("Clearing embed and showing placeholder"),a.remove.active(),a.remove.embed(),a.showPlaceholder(),n.onReset.call(t)},show:function(){a.debug("Showing embed"),a.set.active(),n.onDisplay.call(t)},hide:function(){a.debug("Hiding embed"),a.showPlaceholder()},showPlaceholder:function(){a.debug("Showing placeholder image"),a.remove.active(),n.onPlaceholderDisplay.call(t)},get:{id:function(){return n.id||t.dataset[d.id]},placeholder:function(){return n.placeholder||t.dataset[d.placeholder]},icon:function(){return n.icon?n.icon:void 0!==t.dataset[d.icon]?t.dataset[d.icon]:a.determine.icon()},source:function(e){return n.source?n.source:void 0!==t.dataset[d.source]?t.dataset[d.source]:a.determine.source()},type:function(){var e=a.get.source();return void 0!==c[e]&&c[e].type},url:function(){return n.url?n.url:void 0!==t.dataset[d.url]?t.dataset[d.url]:a.determine.url()}},determine:{autoplay:function(){a.should.autoplay()&&(n.autoplay=!0)},source:function(r){var n=!1;return(r=r||a.get.url())&&c.forEach(c,function(e,o){if(-1!==r.search(e.domain))return n=o,!1}),n},icon:function(){var e=a.get.source();return void 0!==c[e]&&c[e].icon},url:function(){var e=n.id||t.dataset[d.id],o=n.source||t.dataset[d.source],r=void 0!==c[o]&&c[o].url.replace("{id}",e);return r&&(t.dataset[d.url]=r),r}},set:{active:function(){t.classList.add(r.active)}},remove:{active:function(){t.classList.remove(r.active)},embed:function(){s.innerHTML=""}},encode:{parameters:function(e){var o,r=[];for(o in e)r.push(encodeURIComponent(o)+"="+encodeURIComponent(e[o]));return r.join("&amp;")}},generate:{embed:function(e){a.debug("Generating embed html");var o,r,n=a.get.source();return(e=a.get.url(e))?(r=a.generate.parameters(n),o=l.iframe(e,r)):a.error(i.noURL,t),o},parameters:function(e,o){var r=c[e]&&void 0!==c[e].parameters?c[e].parameters(n):{};return(o=o||n.parameters)&&(r=vs.extend({},r,o)),r=n.onEmbed(r),a.encode.parameters(r)}},has:{embed:function(){return 0<s.length},placeholder:function(){return n.placeholder||t.dataset[d.placeholder]}},should:{autoplay:function(){return"auto"===n.autoplay?n.placeholder||void 0!==t.dataset[d.placeholder]:n.autoplay}},is:{video:function(){return"video"==a.get.type()}}}},vs.embed.settings={name:"Embed",namespace:"embed",silent:!1,debug:!1,verbose:!1,performance:!0,icon:!1,source:!1,url:!1,id:!1,autoplay:"auto",color:"#444444",hd:!0,brandedUI:!1,parameters:!1,api:!1,onPause:function(){},onPlay:function(){},onStop:function(){},onDisplay:function(){},onPlaceholderDisplay:function(){},onReset:function(){},onCreate:function(e){},onEmbed:function(e){return e},className:{active:"active",embed:"embed"},error:{noURL:"No URL specified",method:"The method you called is not defined"},selector:{embed:".embed",placeholder:".placeholder",icon:".icon"},metadata:{id:"id",icon:"icon",placeholder:"placeholder",source:"source",url:"url"},sources:{youtube:{name:"youtube",type:"video",icon:"video play",domain:"youtube.com",url:"//www.youtube.com/embed/{id}",parameters:function(e){return{autohide:!e.brandedUI,autoplay:e.autoplay,color:e.color||void 0,hq:e.hd,jsapi:e.api,modestbranding:!e.brandedUI}}},vimeo:{name:"vimeo",type:"video",icon:"video play",domain:"vimeo.com",url:"//player.vimeo.com/video/{id}",parameters:function(e){return{api:e.api,autoplay:e.autoplay,byline:e.brandedUI,color:e.color||void 0,portrait:e.brandedUI,title:e.brandedUI}}}},templates:{iframe:function(e,o){var r=e;return o&&(r+="?"+o),'<iframe src="'+r+'" width="100%" height="100%" frameborder="0" scrolling="no" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>'},placeholder:function(e,o){var r="";return o&&(r+='<i class="'+o+' icon"></i>'),e&&(r+='<img class="placeholder" src="'+e+'">'),r}}};